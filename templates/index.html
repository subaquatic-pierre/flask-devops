<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Devop</title>
  </head>
  <body>
    <h1>Devops App</h1>

    <input type="text" id="secret" name="name" />
    <button id="rebuild-button">Run Rebuild</button>

    <h4>Standard Out</h4>
    <div id="std-container" style="color: green"></div>
    <br />

    <h4>Standard Error</h4>
    <div id="err-container" style="color: red"></div>
  </body>

  <script>
    const input = document.getElementById("secret");
    const btn = document.getElementById("rebuild-button");
    const stdContainer = document.getElementById("std-container");
    const errContainer = document.getElementById("err-container");

    const handleFetch = async () => {
      const options = {
        mode: "cors",
        credentials: "same-origin",
      };
      const hostname = window.location.hostname;

      const response = await fetch(
        `https://${hostname}/rebuild/${input.value}`
      );

      const data = await response.json();

      stdContainer.innerHTML = `<pre>data.stdout</pre>`;

      errContainer.innerHTML = `<pre>data.stderr</pre>`;
    };

    btn.addEventListener("click", handleFetch);
  </script>
</html>
